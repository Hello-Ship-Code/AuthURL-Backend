{"version":3,"file":"authMiddleware.js","sourceRoot":"","sources":["../../src/middlewares/authMiddleware.ts"],"names":[],"mappings":";;;AAEA,4CAA2C;AAEpC,MAAM,cAAc,GAAmB,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,EAAE;IAC/D,MAAM,KAAK,GAAG,GAAG,CAAC,OAAO,EAAE,IAAI,CAAA;IAE/B,IAAI,CAAC,KAAK,EAAE,CAAC;QACX,GAAG,CAAC,MAAM,CAAC,UAAU,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,CAAA;QAC1C,OAAM;IACR,CAAC;IAED,MAAM,IAAI,GAAG,IAAA,cAAO,EAAC,KAAK,CAAC,CAAA;IAE3B,IAAI,CAAC,IAAI,EAAE,CAAC;QACV,GAAG,CAAC,MAAM,CAAC,UAAU,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,CAAA;QAC1C,OAAM;IACR,CAAC;IAED,GAAG,CAAC,MAAM,CAAC,IAAI,GAAG,IAAI,CAAA;IAEtB,IAAI,EAAE,CAAA;AACR,CAAC,CAAA;AAlBY,QAAA,cAAc,kBAkB1B","sourcesContent":["import type { RequestHandler } from 'express'\n\nimport { getUser } from '../utils/JWT/auth'\n\nexport const authMiddleware: RequestHandler = (req, res, next) => {\n  const token = req.cookies?.uuid\n\n  if (!token) {\n    res.render('redirect', { path: '/login' })\n    return\n  }\n\n  const user = getUser(token)\n\n  if (!user) {\n    res.render('redirect', { path: '/login' })\n    return\n  }\n\n  res.locals.user = user\n\n  next()\n}\n"]}