"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.appRouter = void 0;
const express_1 = require("express");
const postUrlController_1 = require("../controllers/urls/api/postUrlController");
const urlAnalysis_1 = require("../controllers/urls/api/urlAnalysis");
const login_controller_1 = require("../controllers/users/api/login.controller");
const signup_controller_1 = require("../controllers/users/api/signup.controller");
const upload_controller_1 = require("../controllers/users/api/upload.controller");
const home_view_controller_1 = require("../controllers/users/views/home-view.controller");
const login_view_controller_1 = require("../controllers/users/views/login-view.controller");
const signup_view_controller_1 = require("../controllers/users/views/signup-view.controller");
const upload_view_controller_1 = require("../controllers/users/views/upload-view.controller");
const user_view_controller_1 = require("../controllers/users/views/user-view.controller");
const authMiddleware_1 = require("../middlewares/authMiddleware");
const error_handler_1 = require("../utils/error-handlers/error.handler");
const uploadMulterService_1 = require("../utils/user/uploadMulterService");
const protectedRoutes = (0, express_1.Router)();
protectedRoutes.post('/upload', uploadMulterService_1.upload.single('profilePicture'), upload_controller_1.uploadController);
protectedRoutes.get('/:shortId', urlAnalysis_1.urlAnalysis);
protectedRoutes.get('/', user_view_controller_1.userViewController);
protectedRoutes.post('/', postUrlController_1.postUrlController);
const apiRouter = (0, express_1.Router)();
apiRouter.post('/login', login_controller_1.loginController);
apiRouter.post('/signup', signup_controller_1.signupController);
const htmlRouter = (0, express_1.Router)();
htmlRouter.get('/login', login_view_controller_1.loginViewController);
htmlRouter.get('/signup', signup_view_controller_1.signupViewController);
htmlRouter.get('/upload', upload_view_controller_1.uploadViewController);
htmlRouter.get('/', home_view_controller_1.homeViewController);
const appRouter = (app) => {
    app.use('/user', authMiddleware_1.authMiddleware, protectedRoutes);
    app.use('/api', apiRouter);
    app.use('/', htmlRouter);
    app.use(error_handler_1.errorHandler);
    app.use((_, response) => {
        response.redirect('/');
    });
};
exports.appRouter = appRouter;
//# sourceMappingURL=router.js.map